C51 COMPILER V9.57.0.0   MAIN                                                              09/08/2019 16:15:09 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\keil\install\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /**********************实验测试程序************************
   2          *  平台：BST-V51 + Keil U5 + STC89C52RC
   3          *  名称：定时器中断实验
   4          *  日期：2019-9-8
   5          *  姓名：ZhangHJ
   6          *  说明：使用定时器中断控制LED
   7          ***********************************************************/
   8          #include<reg52.h>
   9          #include"bstv51.h"
  10          
  11          uint i = 0;         //计时器全局变量
  12          
  13          /**********************************************************
  14          *  函数名称：定时器初始化函数
  15          *  日期：2019-9-8
  16          *  姓名：ZhangHJ
  17          *  说明：设置计时器模式寄存器(TMOD)
  18          *        由TH0和TL0做定时数,设置工作模式1,16位计时器(计时范围0~65535=>0~71.11ms)
  19          *        参数High设置计时器高8位数据;Low设置计时器低8位数据
  20          ***********************************************************/
  21          void init_timer0(unsigned int High, unsigned int Low)
  22          {
  23   1        TMOD |= 0x01;     //设置计时器模式寄存器
  24   1        TH0 = High;       //计时器高八位
  25   1        TL0 = Low;        //计时器低八位
  26   1        EA = 1;           //开启整体计时器允许
  27   1        ET0 = 1;          //计时器中断允许
  28   1        TR0 = 1;          //T0定时器开始运行
  29   1      }
  30          
  31          
  32          
  33          /**********************************************************
  34          *  函数名称：数码管测试函数
  35          *  日期：2019-9-8
  36          *  姓名：ZhangHJ
  37          *  说明：开启数码管所有段选位和位选,数码管全亮
  38          ***********************************************************/
  39          void led_all_on(void)
  40          {
  41   1        P0 = 0xff;
  42   1        DU = 1;
  43   1        DU = 0;
  44   1        P0 = 0x00;
  45   1        WE = 1;
  46   1        WE = 0;
  47   1      }
  48          
  49          
  50          
  51          /**********************************************************
  52          *  函数名称：定时器测试主函数
  53          *  日期：2019-9-8
  54          *  姓名：ZhangHJ
C51 COMPILER V9.57.0.0   MAIN                                                              09/08/2019 16:15:09 PAGE 2   

  55          *  说明：设置计时器定时时间为50ms,主循环判断计时0.5s(计时器累加10次),
  56          *        LED5取反,LED闪烁周期为1S.
  57          ***********************************************************/
  58          int main()
  59          {
  60   1        bstv51_init();
  61   1        init_timer0(0x4C, 0x00);
  62   1        //led_all_on();
  63   1        while(1)
  64   1        {
  65   2          if(i == 10)
  66   2          {
  67   3            L5 = ~L5;
  68   3            i = 0;
  69   3          }
  70   2        }
  71   1      }
  72          
  73          
  74          
  75          /**********************************************************
  76          *  函数名称：定时器测试函数
  77          *  日期：2019-9-8
  78          *  姓名：ZhangHJ
  79          *  说明：重置定时器高八位和低八位数据,计时器变量 i 加 1 
  80          *        因为定时器中断时间为50ms(时间很短),所以中断服务函数中,
  81          *        不建议写太长的执行语句。
  82          ***********************************************************/
  83          void timer_isp(void) interrupt 1
  84          {
  85   1        TH0 = 0X4C;       //计时器高八位清0
  86   1        TL0 = 0X00;       //计时器低八位清0
  87   1        i ++;
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     76    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
